(()=>{"use strict";const e=MathJax._.input.tex.Configuration,t=e.Configuration,a=(e.ConfigurationHandler,e.ParserConfiguration,MathJax._.input.tex.TokenMap),n=(a.parseResult,a.AbstractTokenMap,a.RegExpMap,a.AbstractParseMap,a.CharacterMap,a.DelimiterMap,a.MacroMap,a.CommandMap),r=(a.EnvironmentMap,MathJax._.input.tex.Token),o=(r.Token,r.Macro),s=MathJax._.input.tex.TexError.default,c=MathJax._.input.tex.ParseUtil,i=(c.KeyValueType,c.KeyValueTypes,c.ParseUtil),u=MathJax._.input.tex.UnitUtil.UnitUtil,l="xparseCmdMap";let m={};const f=(e,t,a,n)=>{const r=JSON.parse(n);if(r.length){const n=[];for(const a of r)switch(a.type){case"m":n.push(e.GetArgument(t));break;case"o":n.push(e.GetBrackets(t)||"-NoValue-");break;case"O":n.push(e.GetBrackets(t)||a.default);break;case"s":n.push(e.GetStar()?"\\BooleanTrue":"\\BooleanFalse");break;case"t":{const t=e.GetNext()===a.token;t&&e.i++,n.push(t?"\\BooleanTrue":"\\BooleanFalse");break}}a=i.substituteArgs(e,n,a)}e.string=i.addArgs(e,a,e.string.slice(e.i)),e.i=0,i.checkMaxMacros(e)};m.documentCmd=function(e,t){const a=function(e,t){let a=u.trimSpaces(e.GetArgument(t));if("\\"===a.charAt(0)&&(a=a.substring(1)),!a.match(/^(.|[a-z]+)$/i))throw new s("IllegalControlSequenceName","First argument of '%1' must be a command.",e.currentCS);return a}(e,t),n=function(e){const t=[];switch(e.GetNext()){case"}":throw new s("ExtraCloseMissingOpen","Extra close brace or missing open brace");case"{":for(e.i++;e.i<e.string.length;){for(;e.nextIsSpace();)e.i++;const a=e.string.charAt(e.i++);switch(a){case"m":case"o":case"O":{const n=e.GetArgument("O");t.push({type:a,default:n});break}case"s":t.push({type:a});break;case"t":{const n=e.GetArgument("t");t.push({type:a,token:n});break}case"}":return t;case"r":case"R":case"v":case"d":case"D":case"e":case"E":throw new s("NotImplemented","Argument type '"+a+"' not yet supported!");default:throw new s("DocumentCommand","Invalid argument spec '"+a+"' in command definition.")}}throw new s("MissingCloseBrace","aaMissing close brace");default:throw new s("MissingArgFor","Missing argument for %1",e.currentCS)}}(e),r=e.GetArgument(t);e.configuration.handlers.retrieve(l).add(a,new o(a,f,[r,JSON.stringify(n)]))},m.ifBoolean=function(e,t,a){const n=u.trimSpaces(e.GetArgument(t)),r=e.GetArgument(t),o="tf"===a?e.GetArgument(t):"",c=(()=>{switch(n){case"\\BooleanTrue":return!("f"===a);case"\\BooleanFalse":return"f"===a;default:throw new s("InvalidArgument","Invalid argument "+n+" to "+e.currentCS)}})();e.string=i.addArgs(e,c?r:o,e.string.slice(e.i)),e.i=0,i.checkMaxMacros(e)},m.ifNoValue=function(e,t,a){const n=u.trimSpaces(e.GetArgument(t)),r=e.GetArgument(t),o="tf"===a?e.GetArgument(t):"",s="-NoValue-"===n?!("f"===a):"f"===a;e.string=i.addArgs(e,s?r:o,e.string.slice(e.i)),e.i=0,i.checkMaxMacros(e)},new n(l,{NewDocumentCommand:["documentCmd","new"],RenewDocumentCommand:["documentCmd","renew"],ProvideDocumentCommand:["documentCmd","provide"],DeclareDocumentCommand:["documentCmd","declare"],IfBooleanTF:["ifBoolean","tf"],IfBooleanT:["ifBoolean","t"],IfBooleanF:["ifBoolean","f"],IfNoValueTF:["ifNoValue","tf"],IfNoValueT:["ifNoValue","t"],IfNoValueF:["ifNoValue","f"]},m);t.create("xparse",{handler:{macro:[l]}})})();